# -*-coding=utf-8-*-
__author__ = 'aqua'

import time
import random
import requests
import re
import pandas as pd
from sqlalchemy import create_engine
from HYConceptParser import HYConceptParser

header = {
        'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
        'Accept-Encoding':'gzip, deflate',
        'Accept-Language':'en-US,en;q=0.9',
        'Cache-Control':'max-age=0',
        'Connection':'keep-alive',
        'Cookie':'uaid=3e9d33c7f0daebe595757fcd5d3722ba; searchGuide=sg; spversion=20130314; historystock=000610%7C*%7C000593%7C*%7C603706%7C*%7C002806%7C*%7C300069; BAIDU_SSP_lcr=http://www.yamixed.com/fav/article/2/157; __utma=156575163.844587348.1519633850.1538122047.1538182476.119; __utmc=156575163; __utmz=156575163.1538182476.119.119.utmcsr=yamixed.com|utmccn=(referral)|utmcmd=referral|utmcct=/fav/article/2/157; Hm_lvt_78c58f01938e4d85eaf619eae71b4ed1=1537852532,1537925932,1538122050,1538182486; Hm_lvt_f79b64788a4e377c608617fba4c736e2=1537925933,1538122050,1538122060,1538182486; Hm_lvt_60bad21af9c824a4a0530d5dbf4357ca=1537925932,1538122050,1538122060,1538182487; Hm_lpvt_78c58f01938e4d85eaf619eae71b4ed1=1538198127; Hm_lpvt_f79b64788a4e377c608617fba4c736e2=1538198127; Hm_lpvt_60bad21af9c824a4a0530d5dbf4357ca=1538198127; v=AmbQFCR6AV6mldX6igcd9ePjt9frR6pFfIneYFAOUHdlPwjBuNf6EUwbLncj',
        'Host':'q.10jqka.com.cn',
        'Referer':'http://q.10jqka.com.cn/thshy/',
        'Upgrade-Insecure-Requests':'1',
        'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36'
    }


header_gn_main = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
    'Accept-Encoding': 'gzip, deflate',
    'Accept-Language': 'en-US,en;q=0.9',
    'Cache-Control': 'max-age=0',
    'Connection': 'keep-alive',
    'Cookie': 'uaid=3e9d33c7f0daebe595757fcd5d3722ba; searchGuide=sg; spversion=20130314; historystock=000610%7C*%7C000593%7C*%7C603706%7C*%7C002806%7C*%7C300069; BAIDU_SSP_lcr=http://www.yamixed.com/fav/article/2/157; __utma=156575163.844587348.1519633850.1538122047.1538182476.119; __utmc=156575163; __utmz=156575163.1538182476.119.119.utmcsr=yamixed.com|utmccn=(referral)|utmcmd=referral|utmcct=/fav/article/2/157; __utmb=156575163.1.10.1538182476; Hm_lvt_78c58f01938e4d85eaf619eae71b4ed1=1537852532,1537925932,1538122050,1538182486; Hm_lvt_f79b64788a4e377c608617fba4c736e2=1537925933,1538122050,1538122060,1538182486; Hm_lvt_60bad21af9c824a4a0530d5dbf4357ca=1537925932,1538122050,1538122060,1538182487; Hm_lpvt_60bad21af9c824a4a0530d5dbf4357ca=1538183376; Hm_lpvt_f79b64788a4e377c608617fba4c736e2=1538183376; Hm_lpvt_78c58f01938e4d85eaf619eae71b4ed1=1538183377; v=AvBG9s7kX111XANZSYLzN7k1wbVBOdSD9h0oh-pBvMsepZ5jkkmkE0Yt-BY5',
    'Host': 'data.10jqka.com.cn',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 Safari/537.36'
}    

engine = create_engine('mysql://root:aqua@127.0.0.1/stocking?charset=utf8')
hy = ['881166','881163']
gn = [('http://q.10jqka.com.cn/gn/detail/code/300382/','稀土永磁'),('http://q.10jqka.com.cn/gn/detail/code/300351/','钛白粉'),('http://q.10jqka.com.cn/gn/detail/code/306398/','自由贸易港'),('http://q.10jqka.com.cn/gn/detail/code/301436/','高送转'),('http://q.10jqka.com.cn/gn/detail/code/300085/','氟化工'),('http://q.10jqka.com.cn/gn/detail/code/300157/','草甘膦'),('http://q.10jqka.com.cn/gn/detail/code/302166/','共享单车'),('http://q.10jqka.com.cn/gn/detail/code/301292/','分散染料'),('http://q.10jqka.com.cn/gn/detail/code/308332/','北汽新能源'),('http://q.10jqka.com.cn/gn/detail/code/300870/','新股与次新股'),('http://q.10jqka.com.cn/gn/detail/code/301455/','摘帽'),('http://q.10jqka.com.cn/gn/detail/code/300973/','航运'),('http://q.10jqka.com.cn/gn/detail/code/301543/','细胞免疫治疗'),('http://q.10jqka.com.cn/gn/detail/code/301491/','粤港澳大湾区'),('http://q.10jqka.com.cn/gn/detail/code/300755/','东盟自贸区'),('http://q.10jqka.com.cn/gn/detail/code/302148/','参股万达商业'),('http://q.10jqka.com.cn/gn/detail/code/300898/','尾气治理'),('http://q.10jqka.com.cn/gn/detail/code/301630/','广东自贸区'),('http://q.10jqka.com.cn/gn/detail/code/307264/','空铁WIFI'),('http://q.10jqka.com.cn/gn/detail/code/301497/','啤酒'),('http://q.10jqka.com.cn/gn/detail/code/301402/','上海国资改革'),('http://q.10jqka.com.cn/gn/detail/code/302027/','电子竞技'),('http://q.10jqka.com.cn/gn/detail/code/300777/','稀缺资源'),('http://q.10jqka.com.cn/gn/detail/code/302131/','智能音箱'),('http://q.10jqka.com.cn/gn/detail/code/301564/','跨境电商'),('http://q.10jqka.com.cn/gn/detail/code/302142/','网约车'),('http://q.10jqka.com.cn/gn/detail/code/300134/','PM2.5'),('http://q.10jqka.com.cn/gn/detail/code/300723/','无线充电'),('http://q.10jqka.com.cn/gn/detail/code/301259/','百度概念'),('http://q.10jqka.com.cn/gn/detail/code/300809/','小金属'),('http://q.10jqka.com.cn/gn/detail/code/301565/','医药电商'),('http://q.10jqka.com.cn/gn/detail/code/300316/','氢燃料电池'),('http://q.10jqka.com.cn/gn/detail/code/300158/','超导'),('http://q.10jqka.com.cn/gn/detail/code/306750/','超级品牌'),('http://q.10jqka.com.cn/gn/detail/code/300402/','页岩气'),('http://q.10jqka.com.cn/gn/detail/code/301346/','民营医院'),('http://q.10jqka.com.cn/gn/detail/code/306912/','宁德时代概念'),('http://q.10jqka.com.cn/gn/detail/code/307954/','富士康概念'),('http://q.10jqka.com.cn/gn/detail/code/301558/','阿里巴巴概念'),('http://q.10jqka.com.cn/gn/detail/code/300265/','金改'),('http://q.10jqka.com.cn/gn/detail/code/300883/','新材料概念'),('http://q.10jqka.com.cn/gn/detail/code/301541/','中韩自贸区'),('http://q.10jqka.com.cn/gn/detail/code/304756/','无人零售'),('http://q.10jqka.com.cn/gn/detail/code/301628/','互联网保险'),('http://q.10jqka.com.cn/gn/detail/code/300008/','新能源汽车'),('http://q.10jqka.com.cn/gn/detail/code/307826/','水泥'),('http://q.10jqka.com.cn/gn/detail/code/301631/','二维码识别'),('http://q.10jqka.com.cn/gn/detail/code/300786/','充电桩'),('http://q.10jqka.com.cn/gn/detail/code/300858/','土地流转'),('http://q.10jqka.com.cn/gn/detail/code/301700/','消费金融'),('http://q.10jqka.com.cn/gn/detail/code/301128/','上海自贸区'),('http://q.10jqka.com.cn/gn/detail/code/308296/','送转填权'),('http://q.10jqka.com.cn/gn/detail/code/300105/','海工装备'),('http://q.10jqka.com.cn/gn/detail/code/301502/','O2O概念'),('http://q.10jqka.com.cn/gn/detail/code/301286/','无人驾驶'),('http://q.10jqka.com.cn/gn/detail/code/300920/','智能家居'),('http://q.10jqka.com.cn/gn/detail/code/301171/','深圳国资改革'),('http://q.10jqka.com.cn/gn/detail/code/301365/','一带一路'),('http://q.10jqka.com.cn/gn/detail/code/300023/','食品安全'),('http://q.10jqka.com.cn/gn/detail/code/302150/','蚂蚁金服概念'),('http://q.10jqka.com.cn/gn/detail/code/301797/','智能物流'),('http://q.10jqka.com.cn/gn/detail/code/301623/','地下管网'),('http://q.10jqka.com.cn/gn/detail/code/300649/','迪士尼'),('http://q.10jqka.com.cn/gn/detail/code/302010/','腾讯概念'),('http://q.10jqka.com.cn/gn/detail/code/301121/','特斯拉'),('http://q.10jqka.com.cn/gn/detail/code/300100/','参股券商'),('http://q.10jqka.com.cn/gn/detail/code/304582/','白马股'),('http://q.10jqka.com.cn/gn/detail/code/307512/','石墨电极'),('http://q.10jqka.com.cn/gn/detail/code/301471/','汽车电子'),('http://q.10jqka.com.cn/gn/detail/code/301154/','OLED'),('http://q.10jqka.com.cn/gn/detail/code/301490/','沪股通'),('http://q.10jqka.com.cn/gn/detail/code/300917/','语音技术'),('http://q.10jqka.com.cn/gn/detail/code/300891/','二胎概念'),('http://q.10jqka.com.cn/gn/detail/code/300862/','ST板块'),('http://q.10jqka.com.cn/gn/detail/code/300814/','家用电器'),('http://q.10jqka.com.cn/gn/detail/code/301620/','工业4.0'),('http://q.10jqka.com.cn/gn/detail/code/301539/','职业教育'),('http://q.10jqka.com.cn/gn/detail/code/300733/','锂电池'),('http://q.10jqka.com.cn/gn/detail/code/302170/','微信小程序'),('http://q.10jqka.com.cn/gn/detail/code/300816/','机器人概念'),('http://q.10jqka.com.cn/gn/detail/code/300132/','金融IC'),('http://q.10jqka.com.cn/gn/detail/code/300440/','智能交通'),('http://q.10jqka.com.cn/gn/detail/code/300358/','天然气'),('http://q.10jqka.com.cn/gn/detail/code/305794/','装配式建筑'),('http://q.10jqka.com.cn/gn/detail/code/300722/','卫星导航'),('http://q.10jqka.com.cn/gn/detail/code/300352/','碳纤维'),('http://q.10jqka.com.cn/gn/detail/code/301780/','工业互联网'),('http://q.10jqka.com.cn/gn/detail/code/300769/','生物医药'),('http://q.10jqka.com.cn/gn/detail/code/300353/','特高压'),('http://q.10jqka.com.cn/gn/detail/code/301715/','证金持股'),('http://q.10jqka.com.cn/gn/detail/code/308384/','消费电子'),('http://q.10jqka.com.cn/gn/detail/code/301408/','物流电商平台'),('http://q.10jqka.com.cn/gn/detail/code/301546/','央企国资改革'),('http://q.10jqka.com.cn/gn/detail/code/300163/','车联网'),('http://q.10jqka.com.cn/gn/detail/code/302674/','特色小镇'),('http://q.10jqka.com.cn/gn/detail/code/301179/','冷链物流'),('http://q.10jqka.com.cn/gn/detail/code/301079/','光伏概念'),('http://q.10jqka.com.cn/gn/detail/code/300836/','乡村振兴'),('http://q.10jqka.com.cn/gn/detail/code/300444/','互联网医疗'),('http://q.10jqka.com.cn/gn/detail/code/301085/','芯片概念'),('http://q.10jqka.com.cn/gn/detail/code/301050/','手机游戏'),('http://q.10jqka.com.cn/gn/detail/code/302154/','股权转让'),('http://q.10jqka.com.cn/gn/detail/code/301249/','互联网彩票'),('http://q.10jqka.com.cn/gn/detail/code/300704/','中字头股票'),('http://q.10jqka.com.cn/gn/detail/code/300037/','智能电网'),('http://q.10jqka.com.cn/gn/detail/code/300075/','禽流感'),('http://q.10jqka.com.cn/gn/detail/code/300337/','石墨烯'),('http://q.10jqka.com.cn/gn/detail/code/301663/','互联网'),('http://q.10jqka.com.cn/gn/detail/code/300019/','网络游戏'),('http://q.10jqka.com.cn/gn/detail/code/300389/','参股新三板'),('http://q.10jqka.com.cn/gn/detail/code/301366/','参股民营银行'),('http://q.10jqka.com.cn/gn/detail/code/303944/','MSCI概念'),('http://q.10jqka.com.cn/gn/detail/code/302034/','租售同权'),('http://q.10jqka.com.cn/gn/detail/code/300018/','参股保险'),('http://q.10jqka.com.cn/gn/detail/code/300210/','高校'),('http://q.10jqka.com.cn/gn/detail/code/300900/','融资融券'),('http://q.10jqka.com.cn/gn/detail/code/300804/','脱硫脱硝'),('http://q.10jqka.com.cn/gn/detail/code/300682/','智能医疗'),('http://q.10jqka.com.cn/gn/detail/code/302182/','雄安新区'),('http://q.10jqka.com.cn/gn/detail/code/300127/','3D打印'),('http://q.10jqka.com.cn/gn/detail/code/300831/','美丽中国'),('http://q.10jqka.com.cn/gn/detail/code/300642/','智慧城市'),('http://q.10jqka.com.cn/gn/detail/code/301632/','农村电商'),('http://q.10jqka.com.cn/gn/detail/code/301284/','供应链金融'),('http://q.10jqka.com.cn/gn/detail/code/301636/','深股通'),('http://q.10jqka.com.cn/gn/detail/code/300386/','新疆振兴'),('http://q.10jqka.com.cn/gn/detail/code/301518/','高铁'),('http://q.10jqka.com.cn/gn/detail/code/301100/','足球概念'),('http://q.10jqka.com.cn/gn/detail/code/300835/','大数据'),('http://q.10jqka.com.cn/gn/detail/code/300238/','核电'),('http://q.10jqka.com.cn/gn/detail/code/300806/','文化传媒'),('http://q.10jqka.com.cn/gn/detail/code/301139/','蓝宝石'),('http://q.10jqka.com.cn/gn/detail/code/308002/','独角兽概念'),('http://q.10jqka.com.cn/gn/detail/code/301505/','医疗器械'),('http://q.10jqka.com.cn/gn/detail/code/301209/','互联网金融'),('http://q.10jqka.com.cn/gn/detail/code/300082/','军工'),('http://q.10jqka.com.cn/gn/detail/code/301624/','PPP概念'),('http://q.10jqka.com.cn/gn/detail/code/301146/','基因测序'),('http://q.10jqka.com.cn/gn/detail/code/300186/','电子商务'),('http://q.10jqka.com.cn/gn/detail/code/301699/','虚拟现实'),('http://q.10jqka.com.cn/gn/detail/code/302436/','新零售'),('http://q.10jqka.com.cn/gn/detail/code/300800/','安防'),('http://q.10jqka.com.cn/gn/detail/code/300923/','生态农业'),('http://q.10jqka.com.cn/gn/detail/code/301522/','集成电路'),('http://q.10jqka.com.cn/gn/detail/code/300277/','可燃冰'),('http://q.10jqka.com.cn/gn/detail/code/300362/','通用航空'),('http://q.10jqka.com.cn/gn/detail/code/300378/','物联网'),('http://q.10jqka.com.cn/gn/detail/code/300843/','5G'),('http://q.10jqka.com.cn/gn/detail/code/300890/','高端装备'),('http://q.10jqka.com.cn/gn/detail/code/305790/','燃料乙醇'),('http://q.10jqka.com.cn/gn/detail/code/301683/','能源互联网'),('http://q.10jqka.com.cn/gn/detail/code/301799/','健康中国'),('http://q.10jqka.com.cn/gn/detail/code/301278/','小米概念'),('http://q.10jqka.com.cn/gn/detail/code/301383/','油品改革'),('http://q.10jqka.com.cn/gn/detail/code/301605/','体育产业'),('http://q.10jqka.com.cn/gn/detail/code/300053/','节能照明'),('http://q.10jqka.com.cn/gn/detail/code/300269/','举牌'),('http://q.10jqka.com.cn/gn/detail/code/300756/','网络安全'),('http://q.10jqka.com.cn/gn/detail/code/300419/','云计算'),('http://q.10jqka.com.cn/gn/detail/code/300188/','移动支付'),('http://q.10jqka.com.cn/gn/detail/code/301524/','国产软件'),('http://q.10jqka.com.cn/gn/detail/code/300220/','期货概念'),('http://q.10jqka.com.cn/gn/detail/code/300709/','生物质能'),('http://q.10jqka.com.cn/gn/detail/code/301227/','在线教育'),('http://q.10jqka.com.cn/gn/detail/code/301175/','智能穿戴'),('http://q.10jqka.com.cn/gn/detail/code/300889/','无人机'),('http://q.10jqka.com.cn/gn/detail/code/300730/','节能环保'),('http://q.10jqka.com.cn/gn/detail/code/300374/','污水处理'),('http://q.10jqka.com.cn/gn/detail/code/301602/','赛马概念'),('http://q.10jqka.com.cn/gn/detail/code/300309/','苹果概念'),('http://q.10jqka.com.cn/gn/detail/code/301786/','军民融合'),('http://q.10jqka.com.cn/gn/detail/code/300168/','创投'),('http://q.10jqka.com.cn/gn/detail/code/300084/','煤化工'),('http://q.10jqka.com.cn/gn/detail/code/300983/','乳业'),('http://q.10jqka.com.cn/gn/detail/code/300830/','量子通信'),('http://q.10jqka.com.cn/gn/detail/code/301627/','西安自贸区'),('http://q.10jqka.com.cn/gn/detail/code/300200/','风电'),('http://q.10jqka.com.cn/gn/detail/code/301561/','两桶油改革'),('http://q.10jqka.com.cn/gn/detail/code/302059/','网络直播'),('http://q.10jqka.com.cn/gn/detail/code/300061/','京津冀一体化'),('http://q.10jqka.com.cn/gn/detail/code/302046/','债转股'),('http://q.10jqka.com.cn/gn/detail/code/301306/','农机'),('http://q.10jqka.com.cn/gn/detail/code/301166/','人脸识别'),('http://q.10jqka.com.cn/gn/detail/code/301494/','养老概念'),('http://q.10jqka.com.cn/gn/detail/code/302035/','人工智能'),('http://q.10jqka.com.cn/gn/detail/code/301223/','在线旅游'),('http://q.10jqka.com.cn/gn/detail/code/300013/','大飞机'),('http://q.10jqka.com.cn/gn/detail/code/301236/','福建自贸区'),('http://q.10jqka.com.cn/gn/detail/code/300236/','国产航母'),('http://q.10jqka.com.cn/gn/detail/code/300451/','猪肉'),('http://q.10jqka.com.cn/gn/detail/code/301783/','杭州亚运会'),('http://q.10jqka.com.cn/gn/detail/code/301489/','电力改革'),('http://q.10jqka.com.cn/gn/detail/code/307408/','边缘计算'),('http://q.10jqka.com.cn/gn/detail/code/300073/','振兴东北'),('http://q.10jqka.com.cn/gn/detail/code/301496/','白酒'),('http://q.10jqka.com.cn/gn/detail/code/308176/','数字中国'),('http://q.10jqka.com.cn/gn/detail/code/302045/','区块链'),('http://q.10jqka.com.cn/gn/detail/code/300221/','固废处理'),('http://q.10jqka.com.cn/gn/detail/code/308172/','知识产权保护'),('http://q.10jqka.com.cn/gn/detail/code/301229/','天津自贸区'),('http://q.10jqka.com.cn/gn/detail/code/300345/','水利'),('http://q.10jqka.com.cn/gn/detail/code/300845/','特钢'),('http://q.10jqka.com.cn/gn/detail/code/301213/','电子发票'),('http://q.10jqka.com.cn/gn/detail/code/300248/','黄金')]
hyURL = 'http://q.10jqka.com.cn/thshy/detail/code/'
gn_main_url = 'http://data.10jqka.com.cn/funds/gnzjl/field/tradezdf/order/desc/page/%s/ajax/1/'
failed_gn_main_url = []
gnURL = 'http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/%s/ajax/1/code/'



def parsePage(parser, html, url, concept):
    temps = parser.parse(html)
    if len(temps) == 0:
       print("('%s','%s')" % (url, concept)) 
    codelist = []   
    for temp in temps:
        code_obj = {
            'code' : temp,
            'concept' : concept
        }
        codelist.append(code_obj)
    df = pd.DataFrame(codelist) 
    df.to_sql('ths_concept', con=engine, if_exists='append', index=False)   



def main_page(failed_gn_main_url=failed_gn_main_url):
    parser = HYConceptParser()
    result = []
    real_urls = []
    if len(failed_gn_main_url) != 0:
       real_urls = failed_gn_main_url
    else:
        for i in range(1, 6):
            real_url = (gn_main_url % i)
            real_urls.append(real_url)
    for real_url in real_urls:
        response = requests.get(real_url,headers=header_gn_main, verify=False)
        res = parser.parse_main(response.text)
        if len(res) == 0:
           print(real_url) 
        result += res   
        time.sleep(random.randint(10,15))
    print(result)    

def func(url, hygnList, failed=[('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301436/','高送转'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300157/','草甘膦'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/302166/','共享单车'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301292/','分散染料'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/308332/','北汽新能源'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/4/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/5/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/6/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/7/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/8/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/9/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/10/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/11/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/12/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/13/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/14/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/15/ajax/1/code/300870/','新股与次新股'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300973/','航运'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301543/','细胞免疫治疗'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/301543/','细胞免疫治疗'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301491/','粤港澳大湾区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/301491/','粤港澳大湾区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/4/ajax/1/code/301491/','粤港澳大湾区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/5/ajax/1/code/301491/','粤港澳大湾区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300755/','东盟自贸区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/302148/','参股万达商业'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300898/','尾气治理'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301630/','广东自贸区'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301402/','上海国资改革'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/301402/','上海国资改革'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/4/ajax/1/code/301402/','上海国资改革'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/5/ajax/1/code/301402/','上海国资改革'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/6/ajax/1/code/301402/','上海国资改革'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/302027/','电子竞技'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/302027/','电子竞技'), ('http://q.10jqka.com.cn/gn/detail/code/301564/','跨境电商'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/302142/','网约车'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300134/','PM2.5'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/300134/','PM2.5'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/4/ajax/1/code/300134/','PM2.5'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300723/','无线充电'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/300723/','无线充电'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/301259/','百度概念'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/301259/','百度概念'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/2/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/3/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/4/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/5/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/6/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/7/ajax/1/code/300809/','小金属'), ('http://q.10jqka.com.cn/gn/detail/field/264648/order/desc/page/8/ajax/1/code/300809/','小金属')]):
    parser = HYConceptParser()
    if len(failed) > 0:
       for item in failed:
           response = requests.get(item[0],headers=header, verify=False)   
           parsePage(parser, response.text, item[0], item[1])
           time.sleep(random.randint(10,15))
       return    
    for first_real_url in hygnList:
        response = requests.get(first_real_url[0],headers=header, verify=False)
        g = re.match('(.+)(\d{6})/', first_real_url[0])
        code = g.group(2)
        total_page = parser.get_page_info(response.text)
        parsePage(parser, response.text, first_real_url[0], first_real_url[1])
        if total_page > 1:
           for i in range(2, total_page + 1):
               real_url = (url % i) + code+'/'
               response = requests.get(real_url,headers=header, verify=False)   
               parsePage(parser, response.text, real_url, first_real_url[1])  
               time.sleep(random.randint(10,15))

# func(hyURL,hy)
# main_page()    
func(gnURL,gn)

